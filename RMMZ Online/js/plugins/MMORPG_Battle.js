/*!
 * /*:
 * @target MZ
 * @plugindesc Party Battle
 * @author rmalizia44@gmail.com
 * @url https://rmalizia44.itch.io/
 * @help
 *
 * ⚔️ MMORPG Maker Plugin 0.9.1
 *
 * This plugin is designed for the default turn-based battle system of
 * RPG Maker (and hasn’t been tested with other battle systems yet). It
 * allows players in a party to enter battles together. Players will only
 * join a battle if they are on the same map and not busy with events or
 * in the menu. If one player escapes the battle, they will leave alone,
 * and the others will also need to escape separately.
 *
 * 💖 Special Thanks to Our Patrons!
 *
 * A huge shout-out to everyone supporting the project through Patreon!
 * Your contributions help keep this plugin alive and growing. Here are
 * the amazing supporters from each tier:
 *
 * 🏆 Champion Tier
 *
 * - Emerson
 * - James Shmo
 *
 * 🌟 Legendary Tier
 *
 * - Alexis Naboulet
 * - Ansgar
 * - David Cuellar
 * - Zufran
 *
 * ✨ Epic Tier
 *
 * - Lupilo
 * - Mr.Timbaba
 *
 *
 * @base MMORPG_Party
 * @orderAfter MMORPG_Party
 *
 */(()=>{"use strict";const e=window;var t,a;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const a of e)t[a]=a;return t},e.getValidEnumValues=t=>{const a=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of a)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t},e.find=(e,t)=>{for(const a of e)if(t(a))return a},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(t||(t={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(a||(a={}));const n=t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),s=e=>{switch(typeof e){case"undefined":return n.undefined;case"string":return n.string;case"number":return isNaN(e)?n.nan:n.number;case"boolean":return n.boolean;case"function":return n.function;case"bigint":return n.bigint;case"symbol":return n.symbol;case"object":return Array.isArray(e)?n.array:null===e?n.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?n.promise:"undefined"!=typeof Map&&e instanceof Map?n.map:"undefined"!=typeof Set&&e instanceof Set?n.set:"undefined"!=typeof Date&&e instanceof Date?n.date:n.object;default:return n.unknown}},r=t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class i extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},a={_errors:[]},n=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)a._errors.push(t(s));else{let e=a,n=0;for(;n<s.path.length;){const a=s.path[n];n===s.path.length-1?(e[a]=e[a]||{_errors:[]},e[a]._errors.push(t(s))):e[a]=e[a]||{_errors:[]},e=e[a],n++}}};return n(this),a}static assert(e){if(!(e instanceof i))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,t.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},a=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):a.push(e(n));return{formErrors:a,fieldErrors:t}}get formErrors(){return this.flatten()}}i.create=e=>new i(e);const o=(e,a)=>{let s;switch(e.code){case r.invalid_type:s=e.received===n.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case r.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(e.expected,t.jsonStringifyReplacer)}`;break;case r.unrecognized_keys:s=`Unrecognized key(s) in object: ${t.joinValues(e.keys,", ")}`;break;case r.invalid_union:s="Invalid input";break;case r.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${t.joinValues(e.options)}`;break;case r.invalid_enum_value:s=`Invalid enum value. Expected ${t.joinValues(e.options)}, received '${e.received}'`;break;case r.invalid_arguments:s="Invalid function arguments";break;case r.invalid_return_type:s="Invalid function return type";break;case r.invalid_date:s="Invalid date";break;case r.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(s=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(s=`${s} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?s=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?s=`Invalid input: must end with "${e.validation.endsWith}"`:t.assertNever(e.validation):s="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case r.too_small:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case r.too_big:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case r.custom:s="Invalid input";break;case r.invalid_intersection_types:s="Intersection results could not be merged";break;case r.not_multiple_of:s=`Number must be a multiple of ${e.multipleOf}`;break;case r.not_finite:s="Number must be finite";break;default:s=a.defaultError,t.assertNever(e)}return{message:s}};let d=o;function c(){return d}const u=e=>{const{data:t,path:a,errorMaps:n,issueData:s}=e,r=[...a,...s.path||[]],i={...s,path:r};if(void 0!==s.message)return{...s,path:r,message:s.message};let o="";const d=n.filter((e=>!!e)).slice().reverse();for(const e of d)o=e(i,{data:t,defaultError:o}).message;return{...s,path:r,message:o}};function l(e,t){const a=c(),n=u({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,a,a===o?void 0:o].filter((e=>!!e))});e.common.issues.push(n)}class h{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const a=[];for(const n of t){if("aborted"===n.status)return p;"dirty"===n.status&&e.dirty(),a.push(n.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,t){const a=[];for(const e of t){const t=await e.key,n=await e.value;a.push({key:t,value:n})}return h.mergeObjectSync(e,a)}static mergeObjectSync(e,t){const a={};for(const n of t){const{key:t,value:s}=n;if("aborted"===t.status)return p;if("aborted"===s.status)return p;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!n.alwaysSet||(a[t.value]=s.value)}return{status:e.value,value:a}}}const p=Object.freeze({status:"aborted"}),m=e=>({status:"dirty",value:e}),f=e=>({status:"valid",value:e}),_=e=>"aborted"===e.status,g=e=>"dirty"===e.status,y=e=>"valid"===e.status,v=e=>"undefined"!=typeof Promise&&e instanceof Promise;function b(e,t,a,n){if("a"===a&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?n:"a"===a?n.call(e):n?n.value:t.get(e)}function k(e,t,a,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,a):s?s.value=a:t.set(e,a),a}var x,w,T;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(x||(x={}));class Z{constructor(e,t,a,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=a,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const A=(e,t)=>{if(y(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new i(e.common.issues);return this._error=t,this._error}}};function S(e){if(!e)return{};const{errorMap:t,invalid_type_error:a,required_error:n,description:s}=e;if(t&&(a||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{var r,i;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(r=null!=o?o:n)&&void 0!==r?r:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(i=null!=o?o:a)&&void 0!==i?i:s.defaultError}},description:s}}class O{get description(){return this._def.description}_getType(e){return s(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new h,ctx:{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(v(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const a=this.safeParse(e,t);if(a.success)return a.data;throw a.error}safeParse(e,t){var a;const n={common:{issues:[],async:null!==(a=null==t?void 0:t.async)&&void 0!==a&&a,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},r=this._parseSync({data:e,path:n.path,parent:n});return A(n,r)}"~validate"(e){var t,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:n});return y(t)?{value:t.value}:{issues:n.common.issues}}catch(e){(null===(a=null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase())||void 0===a?void 0:a.includes("encountered"))&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then((e=>y(e)?{value:e.value}:{issues:n.common.issues}))}async parseAsync(e,t){const a=await this.safeParseAsync(e,t);if(a.success)return a.data;throw a.error}async safeParseAsync(e,t){const a={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},n=this._parse({data:e,path:a.path,parent:a}),r=await(v(n)?n:Promise.resolve(n));return A(a,r)}refine(e,t){const a=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const s=e(t),i=()=>n.addIssue({code:r.custom,...a(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(i(),!1))):!!s||(i(),!1)}))}refinement(e,t){return this._refinement(((a,n)=>!!e(a)||(n.addIssue("function"==typeof t?t(a,n):t),!1)))}_refinement(e){return new Oe({schema:this,typeName:De.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Ce.create(this,this._def)}nullable(){return Ne.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ce.create(this)}promise(){return Se.create(this,this._def)}or(e){return he.create([this,e],this._def)}and(e){return _e.create(this,e,this._def)}transform(e){return new Oe({...S(this._def),schema:this,typeName:De.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Re({...S(this._def),innerType:this,defaultValue:t,typeName:De.ZodDefault})}brand(){return new Me({typeName:De.ZodBranded,type:this,...S(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Ee({...S(this._def),innerType:this,catchValue:t,typeName:De.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return $e.create(this,e)}readonly(){return Pe.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const C=/^c[^\s-]{8,}$/i,N=/^[0-9a-z]+$/,R=/^[0-9A-HJKMNP-TV-Z]{26}$/i,E=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,j=/^[a-z0-9_-]{21}$/i,I=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,M=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let P;const B=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,L=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,F=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,D=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,U=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,z=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,V="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",K=new RegExp(`^${V}$`);function W(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function G(e){let t=`${V}T${W(e)}`;const a=[];return a.push(e.local?"Z?":"Z"),e.offset&&a.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${a.join("|")})`,new RegExp(`^${t}$`)}function q(e,t){if(!I.test(e))return!1;try{const[a]=e.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),s=JSON.parse(atob(n));return"object"==typeof s&&null!==s&&(!(!s.typ||!s.alg)&&(!t||s.alg===t))}catch(e){return!1}}function J(e,t){return!("v4"!==t&&t||!L.test(e))||!("v6"!==t&&t||!D.test(e))}class H extends O{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==n.string){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.string,received:t.parsedType}),p}const a=new h;let s;for(const n of this._def.checks)if("min"===n.kind)e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),l(s,{code:r.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if("max"===n.kind)e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),l(s,{code:r.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if("length"===n.kind){const t=e.data.length>n.value,i=e.data.length<n.value;(t||i)&&(s=this._getOrReturnCtx(e,s),t?l(s,{code:r.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):i&&l(s,{code:r.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if("email"===n.kind)$.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"email",code:r.invalid_string,message:n.message}),a.dirty());else if("emoji"===n.kind)P||(P=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),P.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"emoji",code:r.invalid_string,message:n.message}),a.dirty());else if("uuid"===n.kind)E.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"uuid",code:r.invalid_string,message:n.message}),a.dirty());else if("nanoid"===n.kind)j.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"nanoid",code:r.invalid_string,message:n.message}),a.dirty());else if("cuid"===n.kind)C.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"cuid",code:r.invalid_string,message:n.message}),a.dirty());else if("cuid2"===n.kind)N.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"cuid2",code:r.invalid_string,message:n.message}),a.dirty());else if("ulid"===n.kind)R.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"ulid",code:r.invalid_string,message:n.message}),a.dirty());else if("url"===n.kind)try{new URL(e.data)}catch(t){s=this._getOrReturnCtx(e,s),l(s,{validation:"url",code:r.invalid_string,message:n.message}),a.dirty()}else if("regex"===n.kind){n.regex.lastIndex=0;n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"regex",code:r.invalid_string,message:n.message}),a.dirty())}else if("trim"===n.kind)e.data=e.data.trim();else if("includes"===n.kind)e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty());else if("toLowerCase"===n.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===n.kind)e.data=e.data.toUpperCase();else if("startsWith"===n.kind)e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty());else if("endsWith"===n.kind)e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty());else if("datetime"===n.kind){G(n).test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:"datetime",message:n.message}),a.dirty())}else if("date"===n.kind){K.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:"date",message:n.message}),a.dirty())}else if("time"===n.kind){new RegExp(`^${W(n)}$`).test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{code:r.invalid_string,validation:"time",message:n.message}),a.dirty())}else"duration"===n.kind?M.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"duration",code:r.invalid_string,message:n.message}),a.dirty()):"ip"===n.kind?(i=e.data,("v4"!==(o=n.version)&&o||!B.test(i))&&("v6"!==o&&o||!F.test(i))&&(s=this._getOrReturnCtx(e,s),l(s,{validation:"ip",code:r.invalid_string,message:n.message}),a.dirty())):"jwt"===n.kind?q(e.data,n.alg)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"jwt",code:r.invalid_string,message:n.message}),a.dirty()):"cidr"===n.kind?J(e.data,n.version)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"cidr",code:r.invalid_string,message:n.message}),a.dirty()):"base64"===n.kind?U.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"base64",code:r.invalid_string,message:n.message}),a.dirty()):"base64url"===n.kind?z.test(e.data)||(s=this._getOrReturnCtx(e,s),l(s,{validation:"base64url",code:r.invalid_string,message:n.message}),a.dirty()):t.assertNever(n);var i,o;return{status:a.value,value:e.data}}_regex(e,t,a){return this.refinement((t=>e.test(t)),{validation:t,code:r.invalid_string,...x.errToObj(a)})}_addCheck(e){return new H({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...x.errToObj(e)})}url(e){return this._addCheck({kind:"url",...x.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...x.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...x.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...x.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...x.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...x.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...x.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...x.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...x.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...x.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...x.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...x.errToObj(e)})}datetime(e){var t,a;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(a=null==e?void 0:e.local)&&void 0!==a&&a,...x.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...x.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...x.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...x.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...x.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...x.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...x.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...x.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...x.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...x.errToObj(t)})}nonempty(e){return this.min(1,x.errToObj(e))}trim(){return new H({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new H({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new H({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Y(e,t){const a=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=a>n?a:n;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}H.create=e=>{var t;return new H({checks:[],typeName:De.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...S(e)})};class X extends O{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==n.number){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.number,received:t.parsedType}),p}let a;const s=new h;for(const n of this._def.checks)if("int"===n.kind)t.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),l(a,{code:r.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty())}else"multipleOf"===n.kind?0!==Y(e.data,n.value)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),l(a,{code:r.not_finite,message:n.message}),s.dirty()):t.assertNever(n);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,a,n){return new X({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:x.toString(n)}]})}_addCheck(e){return new X({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:x.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:x.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:x.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:x.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&t.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const a of this._def.checks){if("finite"===a.kind||"int"===a.kind||"multipleOf"===a.kind)return!0;"min"===a.kind?(null===t||a.value>t)&&(t=a.value):"max"===a.kind&&(null===e||a.value<e)&&(e=a.value)}return Number.isFinite(t)&&Number.isFinite(e)}}X.create=e=>new X({checks:[],typeName:De.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...S(e)});class Q extends O{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(t){return this._getInvalidInput(e)}if(this._getType(e)!==n.bigint)return this._getInvalidInput(e);let a;const s=new h;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),l(a,{code:r.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):t.assertNever(n);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.bigint,received:t.parsedType}),p}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,a,n){return new Q({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:x.toString(n)}]})}_addCheck(e){return new Q({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Q.create=e=>{var t;return new Q({checks:[],typeName:De.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...S(e)})};class ee extends O{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==n.boolean){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.boolean,received:t.parsedType}),p}return f(e.data)}}ee.create=e=>new ee({typeName:De.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...S(e)});class te extends O{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==n.date){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.date,received:t.parsedType}),p}if(isNaN(e.data.getTime())){return l(this._getOrReturnCtx(e),{code:r.invalid_date}),p}const a=new h;let s;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),l(s,{code:r.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),l(s,{code:r.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):t.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new te({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:x.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:x.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}te.create=e=>new te({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:De.ZodDate,...S(e)});class ae extends O{_parse(e){if(this._getType(e)!==n.symbol){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.symbol,received:t.parsedType}),p}return f(e.data)}}ae.create=e=>new ae({typeName:De.ZodSymbol,...S(e)});class ne extends O{_parse(e){if(this._getType(e)!==n.undefined){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.undefined,received:t.parsedType}),p}return f(e.data)}}ne.create=e=>new ne({typeName:De.ZodUndefined,...S(e)});class se extends O{_parse(e){if(this._getType(e)!==n.null){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.null,received:t.parsedType}),p}return f(e.data)}}se.create=e=>new se({typeName:De.ZodNull,...S(e)});class re extends O{constructor(){super(...arguments),this._any=!0}_parse(e){return f(e.data)}}re.create=e=>new re({typeName:De.ZodAny,...S(e)});class ie extends O{constructor(){super(...arguments),this._unknown=!0}_parse(e){return f(e.data)}}ie.create=e=>new ie({typeName:De.ZodUnknown,...S(e)});class oe extends O{_parse(e){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.never,received:t.parsedType}),p}}oe.create=e=>new oe({typeName:De.ZodNever,...S(e)});class de extends O{_parse(e){if(this._getType(e)!==n.undefined){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.void,received:t.parsedType}),p}return f(e.data)}}de.create=e=>new de({typeName:De.ZodVoid,...S(e)});class ce extends O{_parse(e){const{ctx:t,status:a}=this._processInputParams(e),s=this._def;if(t.parsedType!==n.array)return l(t,{code:r.invalid_type,expected:n.array,received:t.parsedType}),p;if(null!==s.exactLength){const e=t.data.length>s.exactLength.value,n=t.data.length<s.exactLength.value;(e||n)&&(l(t,{code:e?r.too_big:r.too_small,minimum:n?s.exactLength.value:void 0,maximum:e?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),a.dirty())}if(null!==s.minLength&&t.data.length<s.minLength.value&&(l(t,{code:r.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),a.dirty()),null!==s.maxLength&&t.data.length>s.maxLength.value&&(l(t,{code:r.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),a.dirty()),t.common.async)return Promise.all([...t.data].map(((e,a)=>s.type._parseAsync(new Z(t,e,t.path,a))))).then((e=>h.mergeArray(a,e)));const i=[...t.data].map(((e,a)=>s.type._parseSync(new Z(t,e,t.path,a))));return h.mergeArray(a,i)}get element(){return this._def.type}min(e,t){return new ce({...this._def,minLength:{value:e,message:x.toString(t)}})}max(e,t){return new ce({...this._def,maxLength:{value:e,message:x.toString(t)}})}length(e,t){return new ce({...this._def,exactLength:{value:e,message:x.toString(t)}})}nonempty(e){return this.min(1,e)}}function ue(e){if(e instanceof le){const t={};for(const a in e.shape){const n=e.shape[a];t[a]=Ce.create(ue(n))}return new le({...e._def,shape:()=>t})}return e instanceof ce?new ce({...e._def,type:ue(e.element)}):e instanceof Ce?Ce.create(ue(e.unwrap())):e instanceof Ne?Ne.create(ue(e.unwrap())):e instanceof ge?ge.create(e.items.map((e=>ue(e)))):e}ce.create=(e,t)=>new ce({type:e,minLength:null,maxLength:null,exactLength:null,typeName:De.ZodArray,...S(t)});class le extends O{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),a=t.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==n.object){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.object,received:t.parsedType}),p}const{status:t,ctx:a}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof oe&&"strip"===this._def.unknownKeys))for(const e in a.data)i.includes(e)||o.push(e);const d=[];for(const e of i){const t=s[e],n=a.data[e];d.push({key:{status:"valid",value:e},value:t._parse(new Z(a,n,a.path,e)),alwaysSet:e in a.data})}if(this._def.catchall instanceof oe){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of o)d.push({key:{status:"valid",value:e},value:{status:"valid",value:a.data[e]}});else if("strict"===e)o.length>0&&(l(a,{code:r.unrecognized_keys,keys:o}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of o){const n=a.data[t];d.push({key:{status:"valid",value:t},value:e._parse(new Z(a,n,a.path,t)),alwaysSet:t in a.data})}}return a.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of d){const a=await t.key,n=await t.value;e.push({key:a,value:n,alwaysSet:t.alwaysSet})}return e})).then((e=>h.mergeObjectSync(t,e))):h.mergeObjectSync(t,d)}get shape(){return this._def.shape()}strict(e){return x.errToObj,new le({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,a)=>{var n,s,r,i;const o=null!==(r=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,a).message)&&void 0!==r?r:a.defaultError;return"unrecognized_keys"===t.code?{message:null!==(i=x.errToObj(e).message)&&void 0!==i?i:o}:{message:o}}}:{}})}strip(){return new le({...this._def,unknownKeys:"strip"})}passthrough(){return new le({...this._def,unknownKeys:"passthrough"})}extend(e){return new le({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new le({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:De.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new le({...this._def,catchall:e})}pick(e){const a={};return t.objectKeys(e).forEach((t=>{e[t]&&this.shape[t]&&(a[t]=this.shape[t])})),new le({...this._def,shape:()=>a})}omit(e){const a={};return t.objectKeys(this.shape).forEach((t=>{e[t]||(a[t]=this.shape[t])})),new le({...this._def,shape:()=>a})}deepPartial(){return ue(this)}partial(e){const a={};return t.objectKeys(this.shape).forEach((t=>{const n=this.shape[t];e&&!e[t]?a[t]=n:a[t]=n.optional()})),new le({...this._def,shape:()=>a})}required(e){const a={};return t.objectKeys(this.shape).forEach((t=>{if(e&&!e[t])a[t]=this.shape[t];else{let e=this.shape[t];for(;e instanceof Ce;)e=e._def.innerType;a[t]=e}})),new le({...this._def,shape:()=>a})}keyof(){return Te(t.objectKeys(this.shape))}}le.create=(e,t)=>new le({shape:()=>e,unknownKeys:"strip",catchall:oe.create(),typeName:De.ZodObject,...S(t)}),le.strictCreate=(e,t)=>new le({shape:()=>e,unknownKeys:"strict",catchall:oe.create(),typeName:De.ZodObject,...S(t)}),le.lazycreate=(e,t)=>new le({shape:e,unknownKeys:"strip",catchall:oe.create(),typeName:De.ZodObject,...S(t)});class he extends O{_parse(e){const{ctx:t}=this._processInputParams(e),a=this._def.options;if(t.common.async)return Promise.all(a.map((async e=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const a of e)if("dirty"===a.result.status)return t.common.issues.push(...a.ctx.common.issues),a.result;const a=e.map((e=>new i(e.ctx.common.issues)));return l(t,{code:r.invalid_union,unionErrors:a}),p}));{let e;const n=[];for(const s of a){const a={...t,common:{...t.common,issues:[]},parent:null},r=s._parseSync({data:t.data,path:t.path,parent:a});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:a}),a.common.issues.length&&n.push(a.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=n.map((e=>new i(e)));return l(t,{code:r.invalid_union,unionErrors:s}),p}}get options(){return this._def.options}}he.create=(e,t)=>new he({options:e,typeName:De.ZodUnion,...S(t)});const pe=e=>e instanceof xe?pe(e.schema):e instanceof Oe?pe(e.innerType()):e instanceof we?[e.value]:e instanceof Ze?e.options:e instanceof Ae?t.objectValues(e.enum):e instanceof Re?pe(e._def.innerType):e instanceof ne?[void 0]:e instanceof se?[null]:e instanceof Ce?[void 0,...pe(e.unwrap())]:e instanceof Ne?[null,...pe(e.unwrap())]:e instanceof Me||e instanceof Pe?pe(e.unwrap()):e instanceof Ee?pe(e._def.innerType):[];class me extends O{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==n.object)return l(t,{code:r.invalid_type,expected:n.object,received:t.parsedType}),p;const a=this.discriminator,s=t.data[a],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(l(t,{code:r.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),p)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,a){const n=new Map;for(const a of t){const t=pe(a.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(n.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,a)}}return new me({typeName:De.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...S(a)})}}function fe(e,a){const r=s(e),i=s(a);if(e===a)return{valid:!0,data:e};if(r===n.object&&i===n.object){const n=t.objectKeys(a),s=t.objectKeys(e).filter((e=>-1!==n.indexOf(e))),r={...e,...a};for(const t of s){const n=fe(e[t],a[t]);if(!n.valid)return{valid:!1};r[t]=n.data}return{valid:!0,data:r}}if(r===n.array&&i===n.array){if(e.length!==a.length)return{valid:!1};const t=[];for(let n=0;n<e.length;n++){const s=fe(e[n],a[n]);if(!s.valid)return{valid:!1};t.push(s.data)}return{valid:!0,data:t}}return r===n.date&&i===n.date&&+e==+a?{valid:!0,data:e}:{valid:!1}}class _e extends O{_parse(e){const{status:t,ctx:a}=this._processInputParams(e),n=(e,n)=>{if(_(e)||_(n))return p;const s=fe(e.value,n.value);return s.valid?((g(e)||g(n))&&t.dirty(),{status:t.value,value:s.data}):(l(a,{code:r.invalid_intersection_types}),p)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}_e.create=(e,t,a)=>new _e({left:e,right:t,typeName:De.ZodIntersection,...S(a)});class ge extends O{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==n.array)return l(a,{code:r.invalid_type,expected:n.array,received:a.parsedType}),p;if(a.data.length<this._def.items.length)return l(a,{code:r.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),p;!this._def.rest&&a.data.length>this._def.items.length&&(l(a,{code:r.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...a.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new Z(a,e,a.path,t)):null})).filter((e=>!!e));return a.common.async?Promise.all(s).then((e=>h.mergeArray(t,e))):h.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new ge({...this._def,rest:e})}}ge.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ge({items:e,typeName:De.ZodTuple,rest:null,...S(t)})};class ye extends O{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==n.object)return l(a,{code:r.invalid_type,expected:n.object,received:a.parsedType}),p;const s=[],i=this._def.keyType,o=this._def.valueType;for(const e in a.data)s.push({key:i._parse(new Z(a,e,a.path,e)),value:o._parse(new Z(a,a.data[e],a.path,e)),alwaysSet:e in a.data});return a.common.async?h.mergeObjectAsync(t,s):h.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,a){return new ye(t instanceof O?{keyType:e,valueType:t,typeName:De.ZodRecord,...S(a)}:{keyType:H.create(),valueType:e,typeName:De.ZodRecord,...S(t)})}}class ve extends O{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==n.map)return l(a,{code:r.invalid_type,expected:n.map,received:a.parsedType}),p;const s=this._def.keyType,i=this._def.valueType,o=[...a.data.entries()].map((([e,t],n)=>({key:s._parse(new Z(a,e,a.path,[n,"key"])),value:i._parse(new Z(a,t,a.path,[n,"value"]))})));if(a.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const a of o){const n=await a.key,s=await a.value;if("aborted"===n.status||"aborted"===s.status)return p;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const a of o){const n=a.key,s=a.value;if("aborted"===n.status||"aborted"===s.status)return p;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}ve.create=(e,t,a)=>new ve({valueType:t,keyType:e,typeName:De.ZodMap,...S(a)});class be extends O{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==n.set)return l(a,{code:r.invalid_type,expected:n.set,received:a.parsedType}),p;const s=this._def;null!==s.minSize&&a.data.size<s.minSize.value&&(l(a,{code:r.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),null!==s.maxSize&&a.data.size>s.maxSize.value&&(l(a,{code:r.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(e){const a=new Set;for(const n of e){if("aborted"===n.status)return p;"dirty"===n.status&&t.dirty(),a.add(n.value)}return{status:t.value,value:a}}const d=[...a.data.values()].map(((e,t)=>i._parse(new Z(a,e,a.path,t))));return a.common.async?Promise.all(d).then((e=>o(e))):o(d)}min(e,t){return new be({...this._def,minSize:{value:e,message:x.toString(t)}})}max(e,t){return new be({...this._def,maxSize:{value:e,message:x.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}be.create=(e,t)=>new be({valueType:e,minSize:null,maxSize:null,typeName:De.ZodSet,...S(t)});class ke extends O{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==n.function)return l(t,{code:r.invalid_type,expected:n.function,received:t.parsedType}),p;function a(e,a){return u({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),o].filter((e=>!!e)),issueData:{code:r.invalid_arguments,argumentsError:a}})}function s(e,a){return u({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),o].filter((e=>!!e)),issueData:{code:r.invalid_return_type,returnTypeError:a}})}const d={errorMap:t.common.contextualErrorMap},h=t.data;if(this._def.returns instanceof Se){const e=this;return f((async function(...t){const n=new i([]),r=await e._def.args.parseAsync(t,d).catch((e=>{throw n.addIssue(a(t,e)),n})),o=await Reflect.apply(h,this,r);return await e._def.returns._def.type.parseAsync(o,d).catch((e=>{throw n.addIssue(s(o,e)),n}))}))}{const e=this;return f((function(...t){const n=e._def.args.safeParse(t,d);if(!n.success)throw new i([a(t,n.error)]);const r=Reflect.apply(h,this,n.data),o=e._def.returns.safeParse(r,d);if(!o.success)throw new i([s(r,o.error)]);return o.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ke({...this._def,args:ge.create(e).rest(ie.create())})}returns(e){return new ke({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,a){return new ke({args:e||ge.create([]).rest(ie.create()),returns:t||ie.create(),typeName:De.ZodFunction,...S(a)})}}class xe extends O{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xe.create=(e,t)=>new xe({getter:e,typeName:De.ZodLazy,...S(t)});class we extends O{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return l(t,{received:t.data,code:r.invalid_literal,expected:this._def.value}),p}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Te(e,t){return new Ze({values:e,typeName:De.ZodEnum,...S(t)})}we.create=(e,t)=>new we({value:e,typeName:De.ZodLiteral,...S(t)});class Ze extends O{constructor(){super(...arguments),w.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const a=this._getOrReturnCtx(e),n=this._def.values;return l(a,{expected:t.joinValues(n),received:a.parsedType,code:r.invalid_type}),p}if(b(this,w,"f")||k(this,w,new Set(this._def.values),"f"),!b(this,w,"f").has(e.data)){const t=this._getOrReturnCtx(e),a=this._def.values;return l(t,{received:t.data,code:r.invalid_enum_value,options:a}),p}return f(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ze.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ze.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}w=new WeakMap,Ze.create=Te;class Ae extends O{constructor(){super(...arguments),T.set(this,void 0)}_parse(e){const a=t.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==n.string&&s.parsedType!==n.number){const e=t.objectValues(a);return l(s,{expected:t.joinValues(e),received:s.parsedType,code:r.invalid_type}),p}if(b(this,T,"f")||k(this,T,new Set(t.getValidEnumValues(this._def.values)),"f"),!b(this,T,"f").has(e.data)){const e=t.objectValues(a);return l(s,{received:s.data,code:r.invalid_enum_value,options:e}),p}return f(e.data)}get enum(){return this._def.values}}T=new WeakMap,Ae.create=(e,t)=>new Ae({values:e,typeName:De.ZodNativeEnum,...S(t)});class Se extends O{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==n.promise&&!1===t.common.async)return l(t,{code:r.invalid_type,expected:n.promise,received:t.parsedType}),p;const a=t.parsedType===n.promise?t.data:Promise.resolve(t.data);return f(a.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Se.create=(e,t)=>new Se({type:e,typeName:De.ZodPromise,...S(t)});class Oe extends O{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===De.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:a,ctx:n}=this._processInputParams(e),s=this._def.effect||null,r={addIssue:e=>{l(n,e),e.fatal?a.abort():a.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),"preprocess"===s.type){const e=s.transform(n.data,r);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===a.value)return p;const t=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===t.status?p:"dirty"===t.status||"dirty"===a.value?m(t.value):t}));{if("aborted"===a.value)return p;const t=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===t.status?p:"dirty"===t.status||"dirty"===a.value?m(t.value):t}}if("refinement"===s.type){const e=e=>{const t=s.refinement(e,r);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const t=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===t.status?p:("dirty"===t.status&&a.dirty(),e(t.value),{status:a.value,value:t.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((t=>"aborted"===t.status?p:("dirty"===t.status&&a.dirty(),e(t.value).then((()=>({status:a.value,value:t.value}))))))}if("transform"===s.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!y(e))return e;const t=s.transform(e.value,r);if(t instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:t}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>y(e)?Promise.resolve(s.transform(e.value,r)).then((e=>({status:a.value,value:e}))):e))}t.assertNever(s)}}Oe.create=(e,t,a)=>new Oe({schema:e,typeName:De.ZodEffects,effect:t,...S(a)}),Oe.createWithPreprocess=(e,t,a)=>new Oe({schema:t,effect:{type:"preprocess",transform:e},typeName:De.ZodEffects,...S(a)});class Ce extends O{_parse(e){return this._getType(e)===n.undefined?f(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ce.create=(e,t)=>new Ce({innerType:e,typeName:De.ZodOptional,...S(t)});class Ne extends O{_parse(e){return this._getType(e)===n.null?f(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ne.create=(e,t)=>new Ne({innerType:e,typeName:De.ZodNullable,...S(t)});class Re extends O{_parse(e){const{ctx:t}=this._processInputParams(e);let a=t.data;return t.parsedType===n.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Re.create=(e,t)=>new Re({innerType:e,typeName:De.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...S(t)});class Ee extends O{_parse(e){const{ctx:t}=this._processInputParams(e),a={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return v(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new i(a.common.issues)},input:a.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new i(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}Ee.create=(e,t)=>new Ee({innerType:e,typeName:De.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...S(t)});class je extends O{_parse(e){if(this._getType(e)!==n.nan){const t=this._getOrReturnCtx(e);return l(t,{code:r.invalid_type,expected:n.nan,received:t.parsedType}),p}return{status:"valid",value:e.data}}}je.create=e=>new je({typeName:De.ZodNaN,...S(e)});const Ie=Symbol("zod_brand");class Me extends O{_parse(e){const{ctx:t}=this._processInputParams(e),a=t.data;return this._def.type._parse({data:a,path:t.path,parent:t})}unwrap(){return this._def.type}}class $e extends O{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?p:"dirty"===e.status?(t.dirty(),m(e.value)):this._def.out._parseAsync({data:e.value,path:a.path,parent:a})})()}{const e=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===e.status?p:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:a.path,parent:a})}}static create(e,t){return new $e({in:e,out:t,typeName:De.ZodPipeline})}}class Pe extends O{_parse(e){const t=this._def.innerType._parse(e),a=e=>(y(e)&&(e.value=Object.freeze(e.value)),e);return v(t)?t.then((e=>a(e))):a(t)}unwrap(){return this._def.innerType}}function Be(e,t){const a="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof a?{message:a}:a}function Le(e,t={},a){return e?re.create().superRefine(((n,s)=>{var r,i;const o=e(n);if(o instanceof Promise)return o.then((e=>{var r,i;if(!e){const e=Be(t,n),o=null===(i=null!==(r=e.fatal)&&void 0!==r?r:a)||void 0===i||i;s.addIssue({code:"custom",...e,fatal:o})}}));if(!o){const e=Be(t,n),o=null===(i=null!==(r=e.fatal)&&void 0!==r?r:a)||void 0===i||i;s.addIssue({code:"custom",...e,fatal:o})}})):re.create()}Pe.create=(e,t)=>new Pe({innerType:e,typeName:De.ZodReadonly,...S(t)});const Fe={object:le.lazycreate};var De;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(De||(De={}));const Ue=H.create,ze=X.create,Ve=je.create,Ke=Q.create,We=ee.create,Ge=te.create,qe=ae.create,Je=ne.create,He=se.create,Ye=re.create,Xe=ie.create,Qe=oe.create,et=de.create,tt=ce.create,at=le.create,nt=le.strictCreate,st=he.create,rt=me.create,it=_e.create,ot=ge.create,dt=ye.create,ct=ve.create,ut=be.create,lt=ke.create,ht=xe.create,pt=we.create,mt=Ze.create,ft=Ae.create,_t=Se.create,gt=Oe.create,yt=Ce.create,vt=Ne.create,bt=Oe.createWithPreprocess,kt=$e.create,xt={string:e=>H.create({...e,coerce:!0}),number:e=>X.create({...e,coerce:!0}),boolean:e=>ee.create({...e,coerce:!0}),bigint:e=>Q.create({...e,coerce:!0}),date:e=>te.create({...e,coerce:!0})},wt=p;var Tt=Object.freeze({__proto__:null,defaultErrorMap:o,setErrorMap:function(e){d=e},getErrorMap:c,makeIssue:u,EMPTY_PATH:[],addIssueToContext:l,ParseStatus:h,INVALID:p,DIRTY:m,OK:f,isAborted:_,isDirty:g,isValid:y,isAsync:v,get util(){return t},get objectUtil(){return a},ZodParsedType:n,getParsedType:s,ZodType:O,datetimeRegex:G,ZodString:H,ZodNumber:X,ZodBigInt:Q,ZodBoolean:ee,ZodDate:te,ZodSymbol:ae,ZodUndefined:ne,ZodNull:se,ZodAny:re,ZodUnknown:ie,ZodNever:oe,ZodVoid:de,ZodArray:ce,ZodObject:le,ZodUnion:he,ZodDiscriminatedUnion:me,ZodIntersection:_e,ZodTuple:ge,ZodRecord:ye,ZodMap:ve,ZodSet:be,ZodFunction:ke,ZodLazy:xe,ZodLiteral:we,ZodEnum:Ze,ZodNativeEnum:Ae,ZodPromise:Se,ZodEffects:Oe,ZodTransformer:Oe,ZodOptional:Ce,ZodNullable:Ne,ZodDefault:Re,ZodCatch:Ee,ZodNaN:je,BRAND:Ie,ZodBranded:Me,ZodPipeline:$e,ZodReadonly:Pe,custom:Le,Schema:O,ZodSchema:O,late:Fe,get ZodFirstPartyTypeKind(){return De},coerce:xt,any:Ye,array:tt,bigint:Ke,boolean:We,date:Ge,discriminatedUnion:rt,effect:gt,enum:mt,function:lt,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>Le((t=>t instanceof e),t),intersection:it,lazy:ht,literal:pt,map:ct,nan:Ve,nativeEnum:ft,never:Qe,null:He,nullable:vt,number:ze,object:at,oboolean:()=>We().optional(),onumber:()=>ze().optional(),optional:yt,ostring:()=>Ue().optional(),pipeline:kt,preprocess:bt,promise:_t,record:dt,set:ut,strictObject:nt,string:Ue,symbol:qe,transformer:gt,tuple:ot,undefined:Je,union:st,unknown:Xe,void:et,NEVER:wt,ZodIssueCode:r,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:i});const Zt=Tt.unknown(),At=Tt.number().int().finite().safe().nonnegative(),St=At.positive(),Ot=Tt.string().trim().min(3),Ct=Tt.string().trim().length(32),Nt=(Tt.string(),At.lt(8),Tt.string(),At.lt(8),Tt.string(),St.refine((t=>t<e.$dataClasses.length)),St.refine((t=>t<e.$dataTroops.length))),Rt=(St.refine((t=>t<e.$dataItems.length)),St.refine((t=>t<e.$dataArmors.length)),St.refine((t=>t<e.$dataWeapons.length)),St.refine((t=>t<e.$dataSkills.length)),St.refine((t=>t<e.$dataStates.length)),Tt.tuple([Tt.string(),At])),Et=(St.refine((t=>t<e.$gameTroop.members().length)),Tt.tuple([Ot,Tt.number()])),jt=Tt.tuple([Tt.null(),Tt.number()]),It=Tt.union([Et,jt]),Mt=Tt.object({item:Rt,seed:Tt.number().finite().nonnegative().lt(1),targets:Tt.array(It)}),$t=Tt.object({map:Tt.number(),guid:Ct,troop:Nt,canEscape:Tt.boolean(),canLose:Tt.boolean()}),Pt=Tt.object({speed:Tt.number().finite(),subject:It,actions:Tt.array(Mt)}),Bt=Tt.object({}),Lt=window.client,Ft={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Dt;const Ut=new Uint8Array(16);const zt=[];for(let e=0;e<256;++e)zt.push((e+256).toString(16).slice(1));function Vt(e,t=0){return(zt[e[t+0]]+zt[e[t+1]]+zt[e[t+2]]+zt[e[t+3]]+"-"+zt[e[t+4]]+zt[e[t+5]]+"-"+zt[e[t+6]]+zt[e[t+7]]+"-"+zt[e[t+8]]+zt[e[t+9]]+"-"+zt[e[t+10]]+zt[e[t+11]]+zt[e[t+12]]+zt[e[t+13]]+zt[e[t+14]]+zt[e[t+15]]).toLowerCase()}const Kt=function(e,t,a){if(Ft.randomUUID&&!t&&!e)return Ft.randomUUID();const n=(e=e||{}).random??e.rng?.()??function(){if(!Dt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Dt=crypto.getRandomValues.bind(crypto)}return Dt(Ut)}();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){if((a=a||0)<0||a+16>t.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[a+e]=n[e];return t}return Vt(n)};const Wt=function(...e){};function Gt(e){const[t,a,n,s]=function(e){let t=1779033703,a=3144134277,n=1013904242,s=2773480762;for(let r,i=0;i<e.length;i++)r=e.charCodeAt(i),t=a^Math.imul(t^r,597399067),a=n^Math.imul(a^r,2869860233),n=s^Math.imul(n^r,951274213),s=t^Math.imul(s^r,2716044179);return t=Math.imul(n^t>>>18,597399067),a=Math.imul(s^a>>>22,2869860233),n=Math.imul(t^n>>>17,951274213),s=Math.imul(a^s>>>19,2716044179),t^=a^n^s,a^=t,n^=t,s^=t,[t>>>0,a>>>0,n>>>0,s>>>0]}(e);return function(e,t,a,n){return function(){let s=((e|=0)+(t|=0)|0)+(n|=0)|0;return n=n+1|0,e=t^t>>>9,t=(a|=0)+(a<<3)|0,a=(a=a<<21|a>>>11)+s|0,(s>>>0)/4294967296}}(t,a,n,s)}let qt;const Jt=Math.random;function Ht(e){Wt("RAND SEED:",e),qt=e?Gt(e):void 0}function Yt(e){return Math.floor(e).toString(16)}Math.random=function(){if(qt){const e=qt();return Wt("RAND RNG:",e),e}{const e=Jt.call(this);return Wt("RAND OLD:",e),e}};const Xt=e.Game_Party.prototype.updateAttributeRecv;e.Game_Party.prototype.updateAttributeRecv=function(){return!this.inBattle()&&Xt.call(this)};const Qt=e.Game_Party.prototype.onBattleEnd;function ea(e){if(e){if(e.isActor()){const t=e.remote()||Lt.user();return`Actor ${e.name()} (${t}) (${e.actorId()})`}return e.isEnemy()?`Enemy ${e.name()} (${e.enemyId()})`:JSON.stringify(e)}return"???"}function ta(e){if(e.isActor())return[e.remote()||Lt.user(),e.actorId()];if(e.isEnemy())return[null,e.index()];throw new Error(`invalid battler: ${e}`)}function aa(e){return e.map((e=>{return{item:(a=(t=e)._item,[a._dataClass,a._itemId]),seed:Math.random(),targets:t.makeTargets().map(ta)};var t,a}))}function na(t,a){return a.map((a=>function(t,a){const n=new e.Game_Action(t,!0);return n._item._dataClass=a.item[0],n._item._itemId=a.item[1],n._seed=a.seed,n._targets=a.targets.map(sa).filter((e=>!!e)),n}(t,a)))}function sa(t){const[a,n]=t;return null===a?e.$gameTroop.members()[n]:e.BattleManager.isRemote()?a===Lt.user()?e.$gameParty.leader():e.$gameParty.getRemote(a):e.$gameParty.allBattleMembers().find((e=>e.actorId()===n))}e.Game_Party.prototype.onBattleEnd=function(){Qt.call(this),e.BattleManager.reset()},e.Game_Battler.prototype.remotes=function(){return this._remotes||(this._remotes=[]),this._remotes},e.Game_Battler.prototype.currentAction=function(){return this.remotes()[0]},e.Game_Battler.prototype.removeCurrentAction=function(){this.remotes().shift()};const ra=e.Game_Actor.prototype.canInput;e.Game_Actor.prototype.canInput=function(){return!this.remote()&&ra.call(this)};const ia=e.Sprite_Actor.prototype.retreat;e.Sprite_Actor.prototype.retreat=function(){this._actor&&this._actor.remote()||ia.call(this)};const oa=e.Game_Action.prototype.makeTargets;e.Game_Action.prototype.makeTargets=function(){return this._targets?Wt("TARGETS HAS",this._targets.map(ea).join(", ")):(this._targets=oa.call(this),Wt("TARGETS GEN",this._targets.map(ea).join(", "))),this._targets.filter((e=>this.testApply(e)))},e.BattleManager.ready=function(){return this._ready||(this._ready=new Set),this._ready},e.BattleManager.remotes=function(){return this._remotes||(this._remotes=[]),this._remotes},e.BattleManager.isRemote=function(){return!!this._guid},e.BattleManager.pushRemote=function(e){const t=sa(e.subject);Wt("PUSH:",JSON.stringify(e.subject),ea(t));for(const t of e.actions){Wt("  ",JSON.stringify(t.item),t.seed);for(const e of t.targets)Wt("    ",JSON.stringify(e),ea(sa(e)))}!this.isTpb()&&t?.isEnemy()&&this.remotes().some((e=>t===sa(e.subject)))?Wt("PUSH SKIP",JSON.stringify(e.subject),ea(t)):this.remotes().push(e)},e.BattleManager.reset=function(e){this._guid=e,Lt.subscribe("battle",this._guid||null)},e.BattleManager.safePublish=function(e,t,a,n){return!!this._guid&&(Lt.safePublish(e,t,"battle",a,n),!0)};const da=e.BattleManager.setup;e.BattleManager.setupRemote=function(t,a,n,s){this._turnReady=!1,this.ready().clear(),this.remotes().length=0,e.$gameParty.hasRemotes()&&(e.$gameParty.leader().sendAllAttributes(),s||(s=Kt().replaceAll("-",""),e.$gameParty.safePublish($t,!1,"battle",{map:e.$gameMap.mapId(),guid:s,troop:t,canEscape:a,canLose:n})),this.reset(s)),Ht(s),da.call(this,t,a,n);for(const t of e.$gameParty.allMembers())t.remote()||e.$gameParty.hasRemotes()&&t!==e.$gameParty.leader()?t.hide():t.appear();this.partyUpdateAttributeRecv()},e.BattleManager.setup=function(e,t,a){this.setupRemote(e,t,a)},e.BattleManager.updateLocal=function(e){e._actions=e._actions.filter((e=>e.isValid())),e.makeSpeed();const t=e.speed(),a=ta(e),n=aa(e._actions);if(e._actions.length=0,n.length<1)return;const s={speed:t,subject:a,actions:n};this.isRemote()?this.safePublish(Pt,!0,"action",s):this.pushRemote(s)},e.BattleManager.updateAllLocals=function(){let e=null;for(;e=ca.call(this);)e.isActor()&&e.remote()||this.updateLocal(e)};const ca=e.BattleManager.getNextSubject;e.BattleManager.getNextSubject=function(){let e,t;do{e=this.remotes().shift(),t=e?sa(e.subject):void 0}while(t&&!t.isAlive());return t&&t.remotes().push(...na(t,e.actions)),t||null},e.BattleManager.processForcedAction=function(){if(!this._actionForcedBattler)return;const e=this._actionForcedBattler;this._actionForcedBattler=null,this.updateLocal(e)},e.BattleManager.checkTurnReady=function(){if(this._turnReady||this.isTpb())return!0;const t=this.ready();for(const a of e.$gameParty.battleMembers()){const e=a.remote();if(e&&!t.has(e))return!1}return this._turnReady=!0,t.clear(),this.remotes().sort(((e,t)=>t.speed-e.speed)),!0},e.BattleManager.partyUpdateAttributeRecv=function(){Xt.call(e.$gameParty)&&e.$gameTemp.requestBattleRefresh()};const ua=e.BattleManager.startInput;e.BattleManager.startInput=function(){ua.call(this),this.partyUpdateAttributeRecv()};const la=e.BattleManager.startTurn;e.BattleManager.startTurn=function(){this.partyUpdateAttributeRecv(),la.call(this),this.updateAllLocals(),this.isTpb()||this.safePublish(Zt,!1,"ready",null)};const ha=e.BattleManager.updateTurn;e.BattleManager.updateTurn=function(e){this.checkTurnReady()&&(this.isTpb()&&this.updateAllLocals(),ha.call(this,e))};const pa=e.BattleManager.endTurn;e.BattleManager.endTurn=function(){pa.call(this),this.partyUpdateAttributeRecv(),this._turnReady=!1,Ht()};const ma=e.BattleManager.updateAction;e.BattleManager.updateAction=function(){const e=this._action;Ht(function(e,t){let a;return"number"==typeof e&&(a=Yt(e*Number.MAX_SAFE_INTEGER)),e&&"number"==typeof t&&(a+=":",a+=Yt(t)),a}(e?._seed,this._targets?.length)),ma.call(this)};const fa=e.BattleManager.invokeAction;e.BattleManager.invokeAction=function(e,t){var a;Wt("INVOKE:",ea(e),">",(a=this._action,`${a?._item?._dataClass||"???"} (${a?._item?._itemId})`),">",ea(t),this._action?._seed),fa.call(this,e,t),Wt("RESULT:",JSON.stringify(t.result(),void 0,2))};const _a=e.BattleManager.endAction;function ga(t){const a=e.$gameParty.getRemote(t);if(!a)return console.error(`can't find actor: ${t}`);a.appear()}e.BattleManager.endAction=function(){_a.call(this),Ht()},Lt.safeReact(e.Scene_Map,$t,"party","battle",((t,a,n)=>{if(e.$gameMap.isEventRunning())return;const{map:s,troop:r,canEscape:i,canLose:o,guid:d}=n;s===e.$gameMap.mapId()&&(e.BattleManager.setupRemote(r,i,o,d),e.SceneManager.push(e.Scene_Battle))})),Lt.safeReact(e.Scene_Base,Zt,"@","battle",((e,t,a)=>{ga(t)})),Lt.safeReact(e.Scene_Base,Zt,"battle","+",((e,t,a)=>{Lt.sendto(t,"battle"),ga(t)})),Lt.safeReact(e.Scene_Base,Zt,"battle","-",((t,a,n)=>{!function(t){const a=e.$gameParty.getRemote(t);if(!a)return console.error(`can't find actor: ${t}`);a.hide()}(a)})),Lt.safeReact(e.Scene_Battle,Zt,"battle","ready",((t,a,n)=>{e.BattleManager.ready().add(a)})),Lt.safeReact(e.Scene_Battle,Pt,"battle","action",((t,a,n)=>{e.BattleManager.pushRemote(n)})),Lt.safeReact(e.Scene_Battle,Bt,"battle","finish",((e,t,a)=>{}))})();